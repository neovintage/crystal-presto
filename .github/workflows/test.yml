name: Run Specs

on: [push, pull_request]

jobs:
  spec:
    runs-on: ubuntu-latest

    container:
      image: crystallang/crystal:latest

    services:
      presto:
        image: prestosql/presto:330
        ports:
          - 8080:8080

    steps:
      - uses: actions/checkout@v2
      - name: Crystal Version
        run: |
          crystal --version
      - name: Install Shards
        run: |
          shards install
      - name: Sleep for 30 seconds
        uses: jakejarvis/wait-action@master
        with:
          time: '30s'
      - name: Run crystal-presto specs
        run: |
          crystal spec
